# Time Recorder Service

Production-ready приложение на Spring Boot для записи текущего времени в PostgreSQL каждую секунду с поддержкой отказоустойчивости.

## Возможности

- **Автоматическая запись времени**: Записывает текущее время в базу данных каждую секунду
- **Отказоустойчивость**: Корректно обрабатывает недоступность БД с автоматической буферизацией
- **Автопереподключение**: Попытки переподключения каждые 5 секунд при недоступной БД
- **Целостность данных**: Буферизованные записи сохраняются в хронологическом порядке после восстановления
- **Backpressure**: Управление медленными соединениями с настраиваемым лимитом буфера
- **Несколько форматов вывода**: JSON и HTML эндпоинты для получения данных
- **Мониторинг**: Health checks, метрики и дашборд статуса

## API Эндпоинты

### Записи

| Эндпоинт | Метод | Формат | Описание |
|----------|-------|--------|----------|
| `/api/records` | GET | JSON | Записи с пагинацией |
| `/api/records/all` | GET | JSON | Все записи |
| `/api/records/html` | GET | HTML | Интерактивная таблица |

**Параметры запроса для `/api/records`:**
- `page` — Номер страницы (с 0, по умолчанию: 0)
- `size` — Размер страницы (по умолчанию: 100, максимум: 1000)

### Статус и здоровье

| Эндпоинт | Метод | Формат | Описание |
|----------|-------|--------|----------|
| `/api/status` | GET | JSON | Детальный статус системы |
| `/api/status/html` | GET | HTML | Дашборд статуса |
| `/api/health` | GET | JSON | Простая проверка здоровья |
| `/actuator/health` | GET | JSON | Spring Actuator health |
| `/actuator/metrics` | GET | JSON | Метрики приложения |
| `/actuator/prometheus` | GET | Text | Метрики для Prometheus |


## Быстрый старт

### Docker Compose (рекомендуется)

```bash
# Запустить PostgreSQL и приложение
docker-compose up -d

# Посмотреть логи
docker-compose logs -f app

# Открыть в браузере
http://localhost:8080/api/records/html
http://localhost:8080/api/status/html
```

## Тестирование отказоустойчивости

### Симуляция падения БД

```bash
# Остановить PostgreSQL
docker stop timerecorder-db

# Наблюдать логи — должны появиться сообщения о буферизации
docker-compose logs -f app

# Запустить PostgreSQL — должны появиться сообщения о переподключении и сбросе буфера
docker start timerecorder-db
```


## Лицензия

MIT License
