<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="5">
    <title>Записи времени</title>
    <link rel="stylesheet" href="/css/records.css">
</head>
<body>
<h1>Записи времени</h1>

<span th:class="'badge ' + (${connected} ? 'badge-ok' : 'badge-err')">
        База данных: <span th:text="${connected} ? 'подключена' : 'недоступна'">подключена</span>
    </span>

<p class="stats">
    <span>Всего: <b th:text="${totalCount}">0</b></span>
    <span>В буфере: <b th:text="${bufferedCount}">0</b></span>
    <span th:if="${totalPages > 0}">
            Страница <span th:text="${page + 1}">1</span> из <span th:text="${totalPages}">1</span>
        </span>
</p>

<table>
    <tr>
        <th>ID</th>
        <th>Время записи</th>
        <th>Время сохранения</th>
        <th>Из буфера</th>
    </tr>
    <tr th:if="${#lists.isEmpty(records)}">
        <td colspan="4" class="no-data">Записей пока нет</td>
    </tr>
    <tr th:each="rec : ${records}" th:class="${rec.wasBuffered} ? 'buffered-row' : ''">
        <td th:text="${rec.id}">1</td>
        <td th:text="${#temporals.format(rec.recordedAt, 'yyyy-MM-dd HH:mm:ss.SSS')}"></td>
        <td th:text="${#temporals.format(rec.persistedAt, 'yyyy-MM-dd HH:mm:ss.SSS')}"></td>
        <td th:text="${rec.wasBuffered} ? 'Да' : 'Нет'">Нет</td>
    </tr>
</table>

<div class="paging" th:if="${totalPages > 1}">
    <a th:if="${page > 0}" th:href="@{/api/records/html(page=${page - 1}, size=${size})}">← Назад</a>
    <a th:if="${page < totalPages - 1}" th:href="@{/api/records/html(page=${page + 1}, size=${size})}">Вперёд →</a>
</div>

<p class="footnote">
    Страница обновляется каждые 5 секунд. Жёлтые строки — записи из буфера.
</p>
</body>
</html>